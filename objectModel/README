refer to 
http://blog.csdn.net/haoel/archive/2008/10/15/3081328.aspx
http://blog.csdn.net/haoel/archive/2008/10/15/3081385.aspx
